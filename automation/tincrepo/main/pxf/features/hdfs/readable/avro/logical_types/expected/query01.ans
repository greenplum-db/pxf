-- @description query01 for PXF HDFS Readable Avro test case for Avro logical types.

SELECT count(*) from avro_logical_types;
 count
-------
     8
(1 row)

select * from avro_logical_types ;
                 uid                  | decnum  |    dob     |  timemillis  |   timemicros    |      timestampmillis       |        timestampmicros        |    localtimestampmicros    |  localtimestampmillis
--------------------------------------+---------+------------+--------------+-----------------+----------------------------+-------------------------------+----------------------------+-------------------------
 67799edc-11b8-11ec-82a8-0242ac130003 |  130.50 | 2003-10-20 | 04:02:20.334 | 04:02:20.334343 | 2021-10-21 19:48:24.629+00 | 2021-10-21 19:48:24.629556+00 | 2021-10-21 19:48:24.629556 | 2021-10-21 19:48:24.629
 d7130d85-cb94-49b1-a722-d3c842f77d01 |    0.11 | 2024-11-18 | 04:32:28.504 | 04:32:28.508141 | 2020-01-31 13:23:34.345+00 | 2020-01-31 13:23:34.345556+00 | 2020-01-31 13:23:34.345556 | 2020-01-31 13:23:34.345
 f8240c3b-7da3-4bde-9253-d9273435bba6 | 1231.56 | 1997-05-28 | 04:21:18.906 | 04:21:18.906111 | 2020-05-23 19:12:44.123+00 | 2020-05-23 19:12:44.123345+00 | 2020-05-23 19:12:44.123345 | 2020-05-23 19:12:44.123
 565b7e2a-ea95-41ef-b1fb-0be2e5658024 |    0.12 | 2079-08-23 | 02:48:12.387 | 02:48:12.387999 | 2019-05-23 19:12:44.446+00 | 2019-05-23 19:12:44.446556+00 | 2019-05-23 19:12:44.446556 | 2019-05-23 19:12:44.446
 47e2d904-0de3-45e6-8388-36287c445544 |  900.45 | 2003-10-20 | 02:48:22.018 | 02:48:22.018567 | 1974-10-20 05:35:58.091+00 | 2018-01-01 07:59:44.091553+00 | 2018-01-01 07:59:44.091553 | 2018-01-01 07:59:44.091
 3928f462-e193-4dd6-8d42-634c857ff420 |   99.01 | 2052-02-23 | 03:25:44.999 | 03:25:44.999789 | 2021-09-09 18:11:11.222+00 | 2021-09-09 18:11:11.222123+00 | 2021-09-09 18:11:11.222123 | 2021-09-09 18:11:11.222
 41eb1c31-c37d-4ff0-8585-6cb8383a6fd2 |   99.12 | 2033-11-28 | 05:32:01.355 | 05:32:01.355334 | 2021-09-09 15:11:11.678+00 | 2021-09-09 15:11:11.678444+00 | 2021-09-09 15:11:11.678444 | 2021-09-09 15:11:11.678
 1f501214-77df-41d4-958e-467dd8fcb09c | 1111.11 | 2033-02-04 | 09:35:21.245 | 09:35:21.245123 | 2010-10-10 17:10:10.898+00 | 2010-10-10 17:10:10.898556+00 | 2010-10-10 17:10:10.898556 | 2010-10-10 17:10:10.898
(8 rows)


SELECT CAST(timestampmillis AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'PDT' as timestampmillis, CAST(timestampmicros AS TIMESTAMP WITH TIME ZONE) AT TIME ZONE 'PDT' as timestampmicros , localtimestampmicros, localtimestampmillis from avro_logical_types;
     timestampmillis     |      timestampmicros       |    localtimestampmicros    |  localtimestampmillis
-------------------------+----------------------------+----------------------------+-------------------------
 2021-10-21 12:48:24.629 | 2021-10-21 12:48:24.629556 | 2021-10-21 19:48:24.629556 | 2021-10-21 19:48:24.629
 2020-01-31 06:23:34.345 | 2020-01-31 06:23:34.345556 | 2020-01-31 13:23:34.345556 | 2020-01-31 13:23:34.345
 2020-05-23 12:12:44.123 | 2020-05-23 12:12:44.123345 | 2020-05-23 19:12:44.123345 | 2020-05-23 19:12:44.123
 2019-05-23 12:12:44.446 | 2019-05-23 12:12:44.446556 | 2019-05-23 19:12:44.446556 | 2019-05-23 19:12:44.446
 1974-10-19 22:35:58.091 | 2018-01-01 00:59:44.091553 | 2018-01-01 07:59:44.091553 | 2018-01-01 07:59:44.091
 2021-09-09 11:11:11.222 | 2021-09-09 11:11:11.222123 | 2021-09-09 18:11:11.222123 | 2021-09-09 18:11:11.222
 2021-09-09 08:11:11.678 | 2021-09-09 08:11:11.678444 | 2021-09-09 15:11:11.678444 | 2021-09-09 15:11:11.678
 2010-10-10 10:10:10.898 | 2010-10-10 10:10:10.898556 | 2010-10-10 17:10:10.898556 | 2010-10-10 17:10:10.898
(8 rows)

-- set timezone='America/Los_Angeles'

set timezone='America/Los_Angeles';
SET

select * from avro_logical_types;
                 uid                  | decnum  |    dob     |  timemillis  |   timemicros    |      timestampmillis       |        timestampmicros        |    localtimestampmicros    |  localtimestampmillis
--------------------------------------+---------+------------+--------------+-----------------+----------------------------+-------------------------------+----------------------------+-------------------------
 67799edc-11b8-11ec-82a8-0242ac130003 |  130.50 | 2003-10-20 | 04:02:20.334 | 04:02:20.334343 | 2021-10-21 12:48:24.629-07 | 2021-10-21 12:48:24.629556-07 | 2021-10-21 19:48:24.629556 | 2021-10-21 19:48:24.629
 d7130d85-cb94-49b1-a722-d3c842f77d01 |    0.11 | 2024-11-18 | 04:32:28.504 | 04:32:28.508141 | 2020-01-31 05:23:34.345-08 | 2020-01-31 05:23:34.345556-08 | 2020-01-31 13:23:34.345556 | 2020-01-31 13:23:34.345
 f8240c3b-7da3-4bde-9253-d9273435bba6 | 1231.56 | 1997-05-28 | 04:21:18.906 | 04:21:18.906111 | 2020-05-23 12:12:44.123-07 | 2020-05-23 12:12:44.123345-07 | 2020-05-23 19:12:44.123345 | 2020-05-23 19:12:44.123
 565b7e2a-ea95-41ef-b1fb-0be2e5658024 |    0.12 | 2079-08-23 | 02:48:12.387 | 02:48:12.387999 | 2019-05-23 12:12:44.446-07 | 2019-05-23 12:12:44.446556-07 | 2019-05-23 19:12:44.446556 | 2019-05-23 19:12:44.446
 47e2d904-0de3-45e6-8388-36287c445544 |  900.45 | 2003-10-20 | 02:48:22.018 | 02:48:22.018567 | 1974-10-19 22:35:58.091-07 | 2017-12-31 23:59:44.091553-08 | 2018-01-01 07:59:44.091553 | 2018-01-01 07:59:44.091
 3928f462-e193-4dd6-8d42-634c857ff420 |   99.01 | 2052-02-23 | 03:25:44.999 | 03:25:44.999789 | 2021-09-09 11:11:11.222-07 | 2021-09-09 11:11:11.222123-07 | 2021-09-09 18:11:11.222123 | 2021-09-09 18:11:11.222
 41eb1c31-c37d-4ff0-8585-6cb8383a6fd2 |   99.12 | 2033-11-28 | 05:32:01.355 | 05:32:01.355334 | 2021-09-09 08:11:11.678-07 | 2021-09-09 08:11:11.678444-07 | 2021-09-09 15:11:11.678444 | 2021-09-09 15:11:11.678
 1f501214-77df-41d4-958e-467dd8fcb09c | 1111.11 | 2033-02-04 | 09:35:21.245 | 09:35:21.245123 | 2010-10-10 10:10:10.898-07 | 2010-10-10 10:10:10.898556-07 | 2010-10-10 17:10:10.898556 | 2010-10-10 17:10:10.898
(8 rows)

