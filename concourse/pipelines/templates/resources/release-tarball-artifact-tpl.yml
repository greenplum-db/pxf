{# Template for a PXF release tarball artifact resource definition.
 #
 # Expects a dictionary with the name 'x' to be set as defined in macros.j2 file
 #}

{# include release tarball artifacts only if the test os is centos to avoid duplicates #}
{% if x.test_os == 'centos' %}
{# release tarball artifacts are only needed for gp5 and gp6, we produce only rpms for gp7 #}
{% if x.gp_ver != '7' %}

- name: pxf-gp[[x.gp_ver]]-tarball-release-to-releng
  type: gcs
  source:
    bucket: ((ud/pxf/[[environment]]/releng-drop-bucket-name))
    json_key: ((concourse-gcs-resources-service-account-key))
    regexp: ((ud/pxf/common/releng-drop-path))/gpdb[[x.gp_ver]]/pxf-gp[[x.gp_ver]]-(.*)-[[x.release_platform]].[[x.pkg_arch]].tar.gz

{% endif %}
{% endif %}
